<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>刘云露</title>
    <meta name="description" content="一些有意思的东西">
    <meta name="generator" content="VitePress v1.3.1">
    <link rel="preload stylesheet" href="/books/assets/style.Bga7S-Uc.css" as="style">
    
    <script type="module" src="/books/assets/app.DZRG_Fut.js"></script>
    <link rel="preload" href="/books/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/books/assets/chunks/framework.CSIwbkbz.js">
    <link rel="modulepreload" href="/books/assets/chunks/theme.DyASG-O0.js">
    <link rel="modulepreload" href="/books/assets/pamphlet_webpack5_21 插件开发基础：实例剖析插件基本形态与架构逻辑.md.BIaE80UL.lean.js">
    <meta name="referrer" content="no-referrer">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-37a6d70e><!--[--><!--]--><!--[--><span tabindex="-1" data-v-51e5f5f9></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-51e5f5f9> Skip to content </a><!--]--><!----><header class="VPNav" data-v-37a6d70e data-v-7d9b7077><div class="VPNavBar has-sidebar top" data-v-7d9b7077 data-v-41fb46bd><div class="wrapper" data-v-41fb46bd><div class="container" data-v-41fb46bd><div class="title" data-v-41fb46bd><div class="VPNavBarTitle has-sidebar" data-v-41fb46bd data-v-93b4b4f7><a class="title" href="/books/" data-v-93b4b4f7><!--[--><!--]--><!----><span data-v-93b4b4f7>刘云露</span><!--[--><!--]--></a></div></div><div class="content" data-v-41fb46bd><div class="content-body" data-v-41fb46bd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-41fb46bd><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-41fb46bd data-v-67b87af4><span id="main-nav-aria-label" class="visually-hidden" data-v-67b87af4> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-67b87af4 data-v-8d52832b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-8d52832b><span class="text" data-v-8d52832b><!----><span data-v-8d52832b>小册</span><span class="vpi-chevron-down text-icon" data-v-8d52832b></span></span></button><div class="menu" data-v-8d52832b><div class="VPMenu" data-v-8d52832b data-v-d04c394a><div class="items" data-v-d04c394a><!--[--><!--[--><div class="VPMenuLink" data-v-d04c394a data-v-b292d3dc><a class="VPLink link" href="/books/pamphlet/webpack5/1%20%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86%20Webpack%EF%BC%9A%E6%97%A7%E6%97%B6%E4%BB%A3%E7%9A%84%E7%A0%B4%E5%B1%80%E8%80%85.html" data-v-b292d3dc><!--[-->Webpack5 核心原理与应用实践<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-d04c394a data-v-b292d3dc><a class="VPLink link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/1.%E5%BC%80%E7%AF%87%EF%BC%9A%E7%94%A8%E6%AD%A3%E7%A1%AE%E7%9A%84%E6%96%B9%E5%BC%8F%E5%AD%A6%E4%B9%A0%20TypeScript.html" data-v-b292d3dc><!--[-->TypeScript全面进阶指南<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/books/markdown-examples.html" tabindex="0" data-v-67b87af4 data-v-d2478bd7><!--[--><span data-v-d2478bd7>Examples</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-41fb46bd data-v-4ae8f97a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-4ae8f97a data-v-523e48f8 data-v-fcf68d73><span class="check" data-v-fcf68d73><span class="icon" data-v-fcf68d73><!--[--><span class="vpi-sun sun" data-v-523e48f8></span><span class="vpi-moon moon" data-v-523e48f8></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-41fb46bd data-v-2004f2bd data-v-2a9cbc32><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-2a9cbc32 data-v-ecd2376f><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-41fb46bd data-v-6aecc31b data-v-8d52832b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-8d52832b><span class="vpi-more-horizontal icon" data-v-8d52832b></span></button><div class="menu" data-v-8d52832b><div class="VPMenu" data-v-8d52832b data-v-d04c394a><!----><!--[--><!--[--><!----><div class="group" data-v-6aecc31b><div class="item appearance" data-v-6aecc31b><p class="label" data-v-6aecc31b>Appearance</p><div class="appearance-action" data-v-6aecc31b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-6aecc31b data-v-523e48f8 data-v-fcf68d73><span class="check" data-v-fcf68d73><span class="icon" data-v-fcf68d73><!--[--><span class="vpi-sun sun" data-v-523e48f8></span><span class="vpi-moon moon" data-v-523e48f8></span><!--]--></span></span></button></div></div></div><div class="group" data-v-6aecc31b><div class="item social-links" data-v-6aecc31b><div class="VPSocialLinks social-links-list" data-v-6aecc31b data-v-2a9cbc32><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-2a9cbc32 data-v-ecd2376f><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-41fb46bd data-v-31bf34af><span class="container" data-v-31bf34af><span class="top" data-v-31bf34af></span><span class="middle" data-v-31bf34af></span><span class="bottom" data-v-31bf34af></span></span></button></div></div></div></div><div class="divider" data-v-41fb46bd><div class="divider-line" data-v-41fb46bd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-37a6d70e data-v-812a11e7><div class="container" data-v-812a11e7><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-812a11e7><span class="vpi-align-left menu-icon" data-v-812a11e7></span><span class="menu-text" data-v-812a11e7>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-812a11e7 data-v-7f5e596f><button data-v-7f5e596f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-37a6d70e data-v-c7c5f53b><div class="curtain" data-v-c7c5f53b></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-c7c5f53b><span class="visually-hidden" id="sidebar-aria-label" data-v-c7c5f53b> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-a107e721><section class="VPSidebarItem level-0 has-active" data-v-a107e721 data-v-44e4b979><div class="item" role="button" tabindex="0" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><h2 class="text" data-v-44e4b979>pamphlet</h2><!----></div><div class="items" data-v-44e4b979><!--[--><section class="VPSidebarItem level-1" data-v-44e4b979 data-v-44e4b979><div class="item" role="button" tabindex="0" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><h3 class="text" data-v-44e4b979>advanced-guide-to-mastering-typeScript</h3><!----></div><div class="items" data-v-44e4b979><!--[--><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/1.%E5%BC%80%E7%AF%87%EF%BC%9A%E7%94%A8%E6%AD%A3%E7%A1%AE%E7%9A%84%E6%96%B9%E5%BC%8F%E5%AD%A6%E4%B9%A0%20TypeScript.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>1.开篇：用正确的方式学习 TypeScript</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/2.%E5%B7%A5%E6%AC%B2%E5%96%84%E5%85%B6%E4%BA%8B%EF%BC%9A%E6%89%93%E9%80%A0%E6%9C%80%E8%88%92%E9%80%82%E7%9A%84%20TypeScript%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>2.工欲善其事：打造最舒适的 TypeScript 开发环境</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/3.%E8%BF%9B%E5%85%A5%E7%B1%BB%E5%9E%8B%E7%9A%84%E4%B8%96%E7%95%8C%EF%BC%9A%E7%90%86%E8%A7%A3%E5%8E%9F%E5%A7%8B%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%AF%B9%E8%B1%A1%E7%B1%BB%E5%9E%8B.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>3.进入类型的世界：理解原始类型与对象类型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/4.%E6%8E%8C%E6%8F%A1%E5%AD%97%E9%9D%A2%E9%87%8F%E7%B1%BB%E5%9E%8B%E4%B8%8E%E6%9E%9A%E4%B8%BE%EF%BC%8C%E8%AE%A9%E4%BD%A0%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%86%8D%E7%B2%BE%E7%A1%AE%E4%B8%80%E4%BA%9B.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>4.掌握字面量类型与枚举，让你的类型再精确一些</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/5.%E5%87%BD%E6%95%B0%E4%B8%8E%20Class%20%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%9E%8B%EF%BC%9A%E8%AF%A6%E8%A7%A3%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>5.函数与 Class 中的类型：详解函数重载与面向对象</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/6.%E6%8E%A2%E7%A7%98%E5%86%85%E7%BD%AE%E7%B1%BB%E5%9E%8B%EF%BC%9Aany%E3%80%81unknown%E3%80%81never%20%E4%B8%8E%E7%B1%BB%E5%9E%8B%E6%96%AD%E8%A8%80.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>6.探秘内置类型：any、unknown、never 与类型断言</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/7.%E7%B1%BB%E5%9E%8B%E7%BC%96%E7%A8%8B%E5%A5%BD%E5%B8%AE%E6%89%8B%EF%BC%9ATypeScript%20%E7%B1%BB%E5%9E%8B%E5%B7%A5%E5%85%B7%EF%BC%88%E4%B8%8A%EF%BC%89.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>7.类型编程好帮手：TypeScript 类型工具（上）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/8.%E7%B1%BB%E5%9E%8B%E7%BC%96%E7%A8%8B%E5%A5%BD%E5%B8%AE%E6%89%8B%EF%BC%9ATypeScript%20%E7%B1%BB%E5%9E%8B%E5%B7%A5%E5%85%B7%EF%BC%88%E4%B8%8B%EF%BC%89.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>8.类型编程好帮手：TypeScript 类型工具（下）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/9.%E7%B1%BB%E5%9E%8B%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%9F%B3%EF%BC%9ATypeScript%20%E4%B8%AD%E6%97%A0%E5%A4%84%E4%B8%8D%E5%9C%A8%E7%9A%84%E6%B3%9B%E5%9E%8B.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>9.类型编程基石：TypeScript 中无处不在的泛型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/10.%E7%BB%93%E6%9E%84%E5%8C%96%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F%EF%BC%9A%E7%B1%BB%E5%9E%8B%E5%85%BC%E5%AE%B9%E6%80%A7%E5%88%A4%E6%96%AD%E7%9A%84%E5%B9%95%E5%90%8E.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>10.结构化类型系统：类型兼容性判断的幕后</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/11.%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F%E5%B1%82%E7%BA%A7%EF%BC%9A%E4%BB%8E%20Top%20Type%20%E5%88%B0%20Bottom%20Type.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>11.类型系统层级：从 Top Type 到 Bottom Type</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/12.%E7%B1%BB%E5%9E%8B%E9%87%8C%E7%9A%84%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%EF%BC%9A%E6%9D%A1%E4%BB%B6%E7%B1%BB%E5%9E%8B%E4%B8%8E%20infer.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>12.类型里的逻辑运算：条件类型与 infer</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/13.%E5%86%85%E7%BD%AE%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%9E%8B%E5%9F%BA%E7%A1%80%EF%BC%9A%E5%88%AB%E5%86%8D%E5%A6%96%E9%AD%94%E5%8C%96%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%9E%8B%E4%BA%86%EF%BC%81.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>13.内置工具类型基础：别再妖魔化工具类型了！</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/14.%E5%8F%8D%E6%96%B9%E5%90%91%E7%B1%BB%E5%9E%8B%E6%8E%A8%E5%AF%BC%EF%BC%9A%E7%94%A8%E5%A5%BD%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9B%B8%E5%85%B3%E7%B1%BB%E5%9E%8B.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>14.反方向类型推导：用好上下文相关类型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/15.%E6%95%B0%E7%B1%BB%E5%9E%8B%EF%BC%9A%E5%8D%8F%E5%8F%98%E4%B8%8E%E9%80%86%E5%8F%98%E7%9A%84%E6%AF%94%E8%BE%83.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>15.数类型：协变与逆变的比较</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/16.%E4%BA%86%E8%A7%A3%E7%B1%BB%E5%9E%8B%E7%BC%96%E7%A8%8B%E4%B8%8E%E7%B1%BB%E5%9E%8B%E4%BD%93%E6%93%8D%E7%9A%84%E6%84%8F%E4%B9%89%EF%BC%8C%E6%89%BE%E5%88%B0%E5%B9%B3%E8%A1%A1%E7%82%B9.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>16.了解类型编程与类型体操的意义，找到平衡点</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/17.%E5%86%85%E7%BD%AE%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%9E%8B%E8%BF%9B%E9%98%B6%EF%BC%9A%E7%B1%BB%E5%9E%8B%E7%BC%96%E7%A8%8B%E8%BF%9B%E9%98%B6.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>17.内置工具类型进阶：类型编程进阶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/18.%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B%E6%96%B0%E6%88%90%E5%91%98%EF%BC%9A%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B%E5%85%A5%E9%97%A8.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>18.基础类型新成员：模板字符串类型入门</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/19.%E7%B1%BB%E5%9E%8B%E7%BC%96%E7%A8%8B%E6%96%B0%E8%8C%83%E5%BC%8F%EF%BC%9A%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%9E%8B%E8%BF%9B%E9%98%B6.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>19.类型编程新范式：模板字符串工具类型进阶</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/20.%E5%B7%A5%E7%A8%8B%E5%B1%82%E9%9D%A2%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%83%BD%E5%8A%9B%EF%BC%9A%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E%E3%80%81%E7%B1%BB%E5%9E%8B%E6%8C%87%E4%BB%A4%E4%B8%8E%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>20.工程层面的类型能力：类型声明、类型指令与命名空间</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/21.%E5%9C%A8%20React%20%E4%B8%AD%E6%84%89%E5%BF%AB%E5%9C%B0%E4%BD%BF%E7%94%A8%20TypeScript%EF%BC%9A%E5%86%85%E7%BD%AE%E7%B1%BB%E5%9E%8B%E4%B8%8E%E6%B3%9B%E5%9E%8B%E5%9D%91%E4%BD%8D.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/22.%E8%AE%A9%20ESLint%20%E6%9D%A5%E7%BA%A6%E6%9D%9F%E4%BD%A0%E7%9A%84%20TypeScript%20%E4%BB%A3%E7%A0%81%EF%BC%9A%E9%85%8D%E7%BD%AE%E4%B8%8E%E8%A7%84%E5%88%99%E9%9B%86%E4%BB%8B%E7%BB%8D.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>22.让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/23.%E5%85%A8%E9%93%BE%E8%B7%AF%20TypeScript%20%E5%B7%A5%E5%85%B7%E5%BA%93%EF%BC%8C%E6%89%BE%E5%88%B0%E9%80%82%E5%90%88%E4%BD%A0%E7%9A%84%E5%B7%A5%E5%85%B7.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>23.全链路 TypeScript 工具库，找到适合你的工具</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/24.%E8%AF%B4%E8%AF%B4%20TypeScript%20%E5%92%8C%20ECMAScript%20%E4%B9%8B%E9%97%B4%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>24.说说 TypeScript 和 ECMAScript 之间那些事儿</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/25.%E8%A3%85%E9%A5%B0%E5%99%A8%E4%B8%8E%E5%8F%8D%E5%B0%84%E5%85%83%E6%95%B0%E6%8D%AE%EF%BC%9A%E4%BA%86%E8%A7%A3%E8%A3%85%E9%A5%B0%E5%99%A8%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>25.装饰器与反射元数据：了解装饰器基本原理与应用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/26.%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC%E4%B8%8E%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%EF%BC%9A%E5%9F%BA%E4%BA%8E%E8%A3%85%E9%A5%B0%E5%99%A8%E7%9A%84%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E5%AE%9E%E7%8E%B0.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>26.控制反转与依赖注入：基于装饰器的依赖注入实现</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/27.TSConfig%20%E5%85%A8%E8%A7%A3%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E6%9E%84%E5%BB%BA%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>27.TSConfig 全解（上）：构建相关配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/28.TSConfig%20%E5%85%A8%E8%A7%A3%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E6%A3%80%E6%9F%A5%E7%9B%B8%E5%85%B3%E3%80%81%E5%B7%A5%E7%A8%8B%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>28.TSConfig 全解（下）：检查相关、工程相关配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/29.%E5%9F%BA%E4%BA%8E%20Prisma%20+%20NestJs%20%E7%9A%84%20Node%20API%20%EF%BC%9A%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%E5%82%A8%E5%A4%87.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>29.基于 Prisma + NestJs 的 Node API ：前置知识储备</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/30.%E5%9F%BA%E4%BA%8E%20Prisma%20+%20NestJs%20%E7%9A%84%20Node%20API%20%EF%BC%9A%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E4%B8%8E%E5%9F%BA%E4%BA%8E%20Heroku%20%E9%83%A8%E7%BD%B2.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>30.基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/31.%E7%8E%A9%E8%BD%AC%20TypeScript%20AST%EF%BC%9AAST%20Checker%20%E4%B8%8E%20CodeMod.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>31.玩转 TypeScript AST：AST Checker 与 CodeMod</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/32.%E6%84%9F%E8%B0%A2%E7%9B%B8%E4%BC%B4%EF%BC%9A%E6%98%AF%E7%BB%93%E6%9D%9F%EF%BC%8C%E4%B9%9F%E6%98%AF%E5%BC%80%E5%A7%8B.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>32.感谢相伴：是结束，也是开始</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/advanced-guide-to-mastering-typeScript/33.%E6%BC%AB%E8%B0%88%E7%AF%87%EF%BC%9A%E9%9D%A2%E8%AF%95%E4%B8%AD%E7%9A%84%20TypeScript.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>33.漫谈篇：面试中的 TypeScript</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 has-active" data-v-44e4b979 data-v-44e4b979><div class="item" role="button" tabindex="0" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><h3 class="text" data-v-44e4b979>webpack5</h3><!----></div><div class="items" data-v-44e4b979><!--[--><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/1%20%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86%20Webpack%EF%BC%9A%E6%97%A7%E6%97%B6%E4%BB%A3%E7%9A%84%E7%A0%B4%E5%B1%80%E8%80%85.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>1 重新认识 Webpack：旧时代的破局者</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/2%20%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%20Webpack%20%E9%85%8D%E7%BD%AE%E5%BA%95%E5%B1%82%E7%BB%93%E6%9E%84%E9%80%BB%E8%BE%91%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>2 如何理解 Webpack 配置底层结构逻辑？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/3%20%E5%A6%82%E4%BD%95%E5%80%9F%E5%8A%A9%20Babel+TS+ESLint%20%E6%9E%84%E5%BB%BA%E7%8E%B0%E4%BB%A3%20JS%20%E5%B7%A5%E7%A8%8B%E7%8E%AF%E5%A2%83%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>3 如何借助 Babel+TS+ESLint 构建现代 JS 工程环境？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/4%20%E5%A6%82%E4%BD%95%E5%80%9F%E5%8A%A9%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8%E3%80%81PostCSS%20%E7%AD%89%E6%9E%84%E5%BB%BA%E7%8E%B0%E4%BB%A3%20CSS%20%E5%B7%A5%E7%A8%8B%E7%8E%AF%E5%A2%83%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>4 如何借助预处理器、PostCSS 等构建现代 CSS 工程环境？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/5%20%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BA%20Vue%20%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>5 如何搭建 Vue 全栈开发环境？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/6%20%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BA%20React%20%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>6 如何搭建 React 全栈开发环境？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/7%20%E4%BD%BF%E7%94%A8%20Webpack%20%E6%9E%84%E5%BB%BA%20NPM%20Library%20%E7%9A%84%E6%AD%A3%E7%A1%AE%E6%96%B9%E5%BC%8F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>7 使用 Webpack 构建 NPM Library 的正确方式</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/8%20%E4%BD%BF%E7%94%A8%20Webpack%20%E6%9E%84%E5%BB%BA%E5%BE%AE%E5%89%8D%E7%AB%AF%E5%BA%94%E7%94%A8.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>8 使用 Webpack 构建微前端应用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/9%20%E5%A6%82%E4%BD%95%E5%80%9F%E5%8A%A9%20Webpack%20%E5%BC%80%E5%8F%91%20PWA%E3%80%81Node%E3%80%81Electron%20%E5%BA%94%E7%94%A8%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>9 如何借助 Webpack 开发 PWA、Node、Electron 应用？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/10%20%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%9B%BE%E5%83%8F%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>10 深入理解图像加载原理与最佳实践</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/11%20%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20Webpack%20%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E7%BB%93%E6%9E%84.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>11 深入理解 Webpack 核心配置结构</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/12%20%E6%9E%84%E5%BB%BA%E6%80%A7%E8%83%BD%EF%BC%9A%E5%88%86%E4%BA%AB%207%20%E6%AC%BE%E5%B8%B8%E7%94%A8%E7%9A%84%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>12 构建性能：分享 7 款常用的性能分析工具</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/13%20%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%20Webpack%20%E6%8C%81%E4%B9%85%E5%8C%96%E7%BC%93%E5%AD%98%E5%A4%A7%E5%B9%85%E6%8F%90%E5%8D%87%E6%9E%84%E5%BB%BA%E6%80%A7%E8%83%BD%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>13 如何使用 Webpack 持久化缓存大幅提升构建性能？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/14%20Webpack%20%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B%E5%AE%9E%E7%8E%B0%E5%B9%B6%E8%A1%8C%E6%9E%84%E5%BB%BA%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>14 Webpack 都有哪些实现并行构建的方法？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/15%20%E6%9C%89%E5%93%AA%E4%BA%9B%E5%80%BC%E5%BE%97%E5%AD%A6%E4%B9%A0%E7%9A%84%E6%9E%84%E5%BB%BA%E6%80%A7%E8%83%BD%E6%9E%81%E8%87%B4%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>15 有哪些值得学习的构建性能极致优化技巧？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/16%20%E5%A6%82%E4%BD%95%E6%AD%A3%E7%A1%AE%E4%BD%BF%E7%94%A8%20SplitChunks%E6%8F%90%E5%8D%87%E5%BA%94%E7%94%A8%E6%80%A7%E8%83%BD%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>16 如何正确使用 SplitChunks提升应用性能？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/17%20%E4%B8%8D%E6%AD%A2%20Terser%EF%BC%9A%E6%8F%AD%E7%A7%98%E4%BB%A3%E7%A0%81%E5%8E%8B%E7%BC%A9%E7%9A%84%E9%97%A8%E9%97%A8%E9%81%93%E9%81%93.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>17 不止 Terser：揭秘代码压缩的门门道道</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/18%20%E8%BF%98%E6%9C%89%E5%93%AA%E4%BA%9B%E5%80%BC%E5%BE%97%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%BA%94%E7%94%A8%E6%80%A7%E8%83%BD%E6%9E%81%E8%87%B4%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>18 还有哪些值得学习的应用性能极致优化技巧？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/19%20Loader%20%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80%EF%BC%9A%E4%BB%8E%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%AD%A6%E5%88%B0%E7%9A%84%20Loader%20%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>19 Loader 开发基础：从开源项目学到的 Loader 开发技巧</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/20%20Loader%20%E5%BC%80%E5%8F%91%E8%BF%9B%E9%98%B6%EF%BC%9A%E5%A6%82%E4%BD%95%E7%94%A8%E5%A5%BD%20Loader%20%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>20 Loader 开发进阶：如何用好 Loader 扩展开发工具？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/21%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80%EF%BC%9A%E5%AE%9E%E4%BE%8B%E5%89%96%E6%9E%90%E6%8F%92%E4%BB%B6%E5%9F%BA%E6%9C%AC%E5%BD%A2%E6%80%81%E4%B8%8E%E6%9E%B6%E6%9E%84%E9%80%BB%E8%BE%91.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>21 插件开发基础：实例剖析插件基本形态与架构逻辑</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/22%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%BF%9B%E9%98%B6%EF%BC%9A%E5%A6%82%E4%BD%95%E6%8F%90%E5%8D%87%E6%8F%92%E4%BB%B6%E5%81%A5%E5%A3%AE%E6%80%A7%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>22 插件开发进阶：如何提升插件健壮性？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/23%20%E6%8F%92%E4%BB%B6%E6%9E%B6%E6%9E%84%EF%BC%9AHook%20%E4%BD%93%E7%B3%BB%E6%98%AF%E5%A6%82%E4%BD%95%E5%BD%B1%E5%93%8D%20Webpack%20%E6%9E%B6%E6%9E%84%E7%9A%84%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>23 插件架构：Hook 体系是如何影响 Webpack 架构的？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/24%20Init%E3%80%81Make%E3%80%81Seal%EF%BC%9A%E7%9C%9F%E6%AD%A3%E8%AF%BB%E6%87%82%20Webpack%20%E6%A0%B8%E5%BF%83%E6%B5%81%E7%A8%8B.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>24 Init、Make、Seal：真正读懂 Webpack 核心流程</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/25%20Dependency%20Graph%EF%BC%9A%E5%A6%82%E4%BD%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97%E9%97%B4%E4%BE%9D%E8%B5%96%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>25 Dependency Graph：如何管理模块间依赖？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/26%20Chunk%EF%BC%9A%E4%B8%89%E7%A7%8D%E4%BA%A7%E7%89%A9%E7%9A%84%E6%89%93%E5%8C%85%E9%80%BB%E8%BE%91.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>26 Chunk：三种产物的打包逻辑</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/27%20Runtime%EF%BC%9A%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91%E6%89%93%E5%8C%85%E5%8F%8A%E8%BF%90%E8%A1%8C%E6%97%B6%E9%80%BB%E8%BE%91.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>27 Runtime：模块编译打包及运行时逻辑</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/28%20Tree-shaking%EF%BC%9A%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E6%97%A0%E7%94%A8%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%87%BA%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>28 Tree-shaking：如何删除无用模块导出？</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/29%20Sourcemap%EF%BC%9A%E6%BA%90%E7%A0%81%E6%98%A0%E5%B0%84%E5%8E%9F%E7%90%86%E4%B8%8E%E5%BA%94%E7%94%A8%E6%8A%80%E5%B7%A7.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>29 Sourcemap：源码映射原理与应用技巧</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-44e4b979 data-v-44e4b979><div class="item" data-v-44e4b979><div class="indicator" data-v-44e4b979></div><a class="VPLink link link" href="/books/pamphlet/webpack5/30%20HMR%EF%BC%9A%E5%A6%82%E4%BD%95%E5%8A%A8%E6%80%81%E6%9B%BF%E6%8D%A2%E9%A1%B5%E9%9D%A2%E4%BB%A3%E7%A0%81%EF%BC%9F.html" data-v-44e4b979><!--[--><p class="text" data-v-44e4b979>30 HMR：如何动态替换页面代码？</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-37a6d70e data-v-3da58578><div class="VPDoc has-sidebar has-aside" data-v-3da58578 data-v-13595e85><!--[--><!--]--><div class="container" data-v-13595e85><div class="aside" data-v-13595e85><div class="aside-curtain" data-v-13595e85></div><div class="aside-container" data-v-13595e85><div class="aside-content" data-v-13595e85><div class="VPDocAside" data-v-13595e85 data-v-907bbbc1><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-907bbbc1 data-v-28f457ea><div class="content" data-v-28f457ea><div class="outline-marker" data-v-28f457ea></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-28f457ea>On this page</div><ul class="VPDocOutlineItem root" data-v-28f457ea data-v-a99553d8><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-907bbbc1></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-13595e85><div class="content-container" data-v-13595e85><!--[--><!--]--><main class="main" data-v-13595e85><div style="position:relative;" class="vp-doc _books_pamphlet_webpack5_21%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80%EF%BC%9A%E5%AE%9E%E4%BE%8B%E5%89%96%E6%9E%90%E6%8F%92%E4%BB%B6%E5%9F%BA%E6%9C%AC%E5%BD%A2%E6%80%81%E4%B8%8E%E6%9E%B6%E6%9E%84%E9%80%BB%E8%BE%91" data-v-13595e85><div><p>Webpack 对外提供了 Loader 与 Plugin 两种扩展方式，其中 Loader 职责比较单一，开发方法比较简单容易理解；Plugin 则功能强大，借助 Webpack 数量庞大的 Hook，我们几乎能改写 Webpack 所有特性，但也伴随着巨大的开发复杂度。</p><p>学习如何开发 Webpack 插件并不是一件简单的事情，所以我打算用 3 个连续的章节，力求足够全面地剖析如何开发一款成熟、稳定的插件。本文将聚焦在插件代码形态、插件架构、Hook 与上下文参数等内容，同时深入剖析若干常用插件的实现原理，帮你构建起关于 Webpack 插件开发的基本认知。</p><h2 id="插件简介" tabindex="-1">插件简介 <a class="header-anchor" href="#插件简介" aria-label="Permalink to &quot;插件简介&quot;">​</a></h2><p>从形态上看，插件通常是一个带有 <code>apply</code> 函数的类，如：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SomePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Webpack 在启动时会调用插件对象的 <code>apply</code> 函数，并以参数方式传递核心对象 <code>compiler</code> ，以此为起点，插件内可以注册 <code>compiler</code> 对象及其子对象的钩子(<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fapi%2Fplugins%2F" target="_blank" rel="noreferrer">Hook</a>)回调，例如：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SomePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compiler.hooks.thisCompilation.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SomePlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compilation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      compilation.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addModule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* ... */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>示例中的 <code>compiler</code> 为 Hook 挂载的对象；<code>thisCompilation</code> 为 Hook 名称；后面调用的 <code>tap</code> 为调用方式，支持 <code>tap/tapAsync/tapPromise</code> 等，后面章节会展开细讲。</p><p>在 Webpack 运行过程中，随着构建流程的推进会触发各个钩子回调，并传入上下文参数(例如上例回调函数中的 <code>compilation</code> 对象)，插件可以通过调用上下文接口、修改上下文状态等方式「篡改」构建逻辑，从而将扩展代码「勾入」到 Webpack 构建流程中。</p><blockquote><p>提示：网上不少资料将 Webpack 的插件架构归类为“事件/订阅”模式，我认为这种归纳有失偏颇。订阅模式是一种<strong>松散耦合结构</strong>，发布器只是在特定时机发布事件消息，订阅者并不或者很少与事件源直接发生交互。</p></blockquote><p>基于 Hook 这一设计，开发插件时我们需要重点关注两个问题：</p><ol><li>针对插件需求，我们应该使用什么钩子？</li><li>选定钩子后，我怎么跟上下文参数交互？</li></ol><blockquote><p>什么时候会触发什么钩子：</p></blockquote><p>Webpack5 暴露了多达 200+ 个 Hook，基本上覆盖了整个构建流程的所有环节 —— 这也就意味着通过编写插件，我们几乎可以改写 Webpack 的所有执行逻辑。问题是，我们在什么情况下该用什么钩子？这就需要了解 Webpack 内部几个核心对象，以及各对象下 Hook 的触发时机，例如：</p><ul><li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fapi%2Fcompiler-hooks%2F" target="_blank" rel="noreferrer">Compiler</a>：全局构建管理器，Webpack 启动后会首先创建 <code>compiler</code> 对象，负责管理配置信息、Loader、Plugin 等。从启动构建到结束，<code>compiler</code> 大致上会触发如下钩子：</li></ul><p><img src="/books/assets/407f8596a5b24203b091a51b5fca6726~tplv-k3u1fbpfcp-zoom-in-crop-mark_3024_0_0_0.Jas6y4WQ.awebp" alt="image.png"></p><ul><li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fapi%2Fcompilation-hooks%2F" target="_blank" rel="noreferrer">Compilation</a>：单次构建过程的管理器，负责遍历模块，执行编译操作；当 <code>watch = true</code> 时，每次文件变更触发重新编译，都会创建一个新的 <code>compilation</code> 对象；<code>compilation</code> 生命周期中主要触发如下钩子：</li></ul><p><img src="/books/assets/08c337e97f664f3da4d301a3a5404f7d~tplv-k3u1fbpfcp-zoom-in-crop-mark_3024_0_0_0.JenUcKCD.awebp" alt="image.png"></p><ul><li>此外，还有 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fapi%2Fnormalmodulefactory-hooks%2F" target="_blank" rel="noreferrer">Module</a>、Resolver、<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fapi%2Fparser%2F" target="_blank" rel="noreferrer">Parser</a>、Generator 等关键类型，也都相应暴露了许多 Hook。</li></ul><p>由此可见，Webpack Hook 与构建流程强相关，使用时你结合上面流程图分析 Hook 对应的流程环节，以及这个环节主要完成了什么工作，可以借助 Hook 做出哪些修改，等等。</p><blockquote><p>使用 Hook 上下文接口：</p></blockquote><p>Webpack Hook 有两个重点，一是上面介绍的触发时机；二是触发时传递的上下文参数。例如：</p><ul><li><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>compiler.hooks.compilation</span></span></code></pre></div><p>：</p><ul><li>时机：Webpack 刚启动完，创建出 <code>compilation</code> 对象后触发；</li><li>参数：当前编译的 <code>compilation</code> 对象。</li></ul></li><li><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>compiler.hooks.make</span></span></code></pre></div><p>：</p><ul><li>时机：正式开始构建时触发；</li><li>参数：同样是当前编译的 <code>compilation</code> 对象。</li></ul></li><li><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>compilation.hooks.optimizeChunks</span></span></code></pre></div><p>：</p><ul><li>时机： <code>seal</code> 函数中，<code>chunk</code> 集合构建完毕后触发；</li><li>参数：<code>chunks</code> 集合与 <code>chunkGroups</code> 集合。</li></ul></li><li><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>compiler.hooks.done</span></span></code></pre></div><p>：</p><ul><li>时机：编译完成后触发；</li><li>参数： <code>stats</code> 对象，包含编译过程中的各类统计信息。</li></ul></li></ul><p>每个钩子传递的上下文参数不同，但主要包含如下几种类型(以 Webpack5 为例)：</p><ul><li><p>complation</p><p>对象：构建管理器，使用率非常高，主要提供了一系列与单次构建相关的接口，包括：</p><ul><li><code>addModule</code>：用于添加模块，例如 Module 遍历出依赖之后，就会调用该接口将新模块添加到构建需求中；</li><li><code>addEntry</code>：添加新的入口模块，效果与直接定义 <code>entry</code> 配置相似；</li><li><code>emitAsset</code>：用于添加产物文件，效果与 Loader Context 的 <code>emitAsset</code> 相同；</li><li><code>getDependencyReference</code>：从给定模块返回对依赖项的引用，常用于计算模块引用关系；</li><li>等等。</li></ul></li><li><p>compiler</p><p>对象：全局构建管理器，提供如下接口：</p><ul><li><code>createChildCompiler</code>：创建子 <code>compiler</code> 对象，子对象将继承原始 Compiler 对象的所有配置数据；</li><li><code>createCompilation</code>：创建 <code>compilation</code> 对象，可以借此实现并行编译；</li><li><code>close</code>：结束编译；</li><li><code>getCache</code>：获取缓存接口，可借此复用 Webpack5 的缓存功能；</li><li><code>getInfrastructureLogger</code>：获取<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fconfiguration%2Fother-options%2F%23infrastructurelogging" target="_blank" rel="noreferrer">日志对象</a>；</li><li>等等。</li></ul></li><li><p>module</p><p>对象：资源模块，有诸如</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>NormalModule/RawModule/ContextModule</span></span></code></pre></div><p>等子类型，其中</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>NormalModule</span></span></code></pre></div><p>使用频率较高，提供如下接口：</p><ul><li><code>identifier</code>：读取模块的唯一标识符；</li><li><code>getCurrentLoader</code>：获取当前正在执行的 Loader 对象；</li><li><code>originalSource</code>：读取模块原始内容；</li><li><code>serialize/deserialize</code>：模块序列化与反序列化函数，用于实现持久化缓存，一般不需要调用；</li><li><code>issuer</code>：模块的引用者；</li><li><code>isEntryModule</code>：用于判断该模块是否为入口文件；</li><li>等等。</li></ul></li><li><p>chunk</p><p>对象：模块封装容器，提供如下接口：</p><ul><li><code>addModule</code>：添加模块，之后该模块会与 Chunk 中其它模块一起打包，生成最终产物；</li><li><code>removeModule</code>：删除模块；</li><li><code>containsModule</code>：判断是否包含某个特定模块；</li><li><code>size</code>：推断最终构建出的产物大小；</li><li><code>hasRuntime</code>：判断 Chunk 中是否包含运行时代码；</li><li><code>updateHash</code>：计算 Hash 值。</li></ul></li><li><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fapi%2Fstats%2F" target="_blank" rel="noreferrer">stats</a> 对象：构建过程收集到的统计信息，包括模块构建耗时、模块依赖关系、产物文件列表等。</p></li></ul><blockquote><p>提示：无论官网还是社区，我都没有找到完整介绍这些对象的，足够好、足够完备的文档，且 Webpack 本身还在不断升级迭代，许多内部对象的接口并不稳定，建议读者使用时直接翻阅相关版本源码。</p></blockquote><p>篇幅关系，我们只对部分重要接口做了简单介绍，后面我还会讲解各种常用插件源码，展开介绍部分常见接口的使用方法。</p><blockquote><p>小结</p></blockquote><p>总结一下，Webpack 的插件体系与平常所见的 <code>订阅/发布</code> 模式差别很大，是一种非常强耦合的设计，Hook 回调由 Webpack 决定何时，以何种方式执行；而在 Hook 回调内部可以通过调用上下文 API 、修改上下文状态等方式，对 Webpack 原定流程产生 Side Effect。</p><p>所以想熟练编写插件，需要深入理解常见 Hook 调用时机，以及各类上下文参数的用法，这方面没有太多学习资料，我建议直接翻阅相关开源插件源码，下面我会抽几个比较经典、逻辑简单、容易理解的插件，剖析如何灵活使用 Hook。</p><h2 id="实例剖析-imagemin-webpack-plugin" tabindex="-1">实例剖析：<code>imagemin-webpack-plugin</code> <a class="header-anchor" href="#实例剖析-imagemin-webpack-plugin" aria-label="Permalink to &quot;实例剖析：`imagemin-webpack-plugin`&quot;">​</a></h2><blockquote><p>学习如何遍历、修改最终产物文件</p></blockquote><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2FKlathmon%2Fimagemin-webpack-plugin" target="_blank" rel="noreferrer">imagemin-webpack-plugin</a> 是一个用于实现图像压缩的插件，它会在 Webpack 完成前置的代码分析构建，提交(<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fapi%2Fcompiler-hooks%2F%23emit" target="_blank" rel="noreferrer">emit</a>)产物时，找出所有图片资源并调用 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fimagemin%2Fimagemin" target="_blank" rel="noreferrer">imagemin</a> 压缩图像。核心逻辑：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ImageminPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // init options</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onEmit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compilation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      await</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">optimizeWebpackImages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(throttle, compilation),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        ...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">optimizeExternalImages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(throttle),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compiler.hooks.emit.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tapAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.name, onEmit);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  optimizeWebpackImages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">throttle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compilation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  optimizeExternalImages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">throttle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>上述代码主要用到 <code>compiler.hooks.emit</code> 钩子，该钩子在 Webpack 完成代码构建与打包操作，准备将产物发送到输出目录之前执行，我们可以在此修改产物内容，如上例 <code>optimizeWebpackImages</code> 函数：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ImageminPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  optimizeWebpackImages</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">throttle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compilation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 用于判断是否对特定文件做图像压缩操作</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        testFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 缓存目录</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        cacheFolder</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.options</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 遍历 `assets` 产物数组</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(compilation.assets, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">asset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">filename</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> throttle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 读取产物内容</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> assetSource</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> asset.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">source</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">testFunction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(filename, assetSource)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          // 尝试从缓存中读取</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> optimizedImageBuffer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getFromCacheIfPossible</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cacheFolder, assetSource, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // 调用 `imagemin` 压缩图片</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> optimizeImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(assetSource, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.options)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          // 之后，使用优化版本替换原始文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          compilation.assets[filename] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RawSource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(optimizedImageBuffer)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>这里面的关键逻辑是：</p><ol><li>遍历 <code>compilation.assets</code> 产物列表，调用 <code>asset.source()</code> 方法读取产物内容；</li><li>调用 <code>imagemin</code> 压缩图片；</li><li>修改 <code>compilation.assets</code>，使用优化后的图片 <code>RawSource</code> 对象替换原始 <code>asset</code> 对象。</li></ol><p>至此完成文件压缩操作。</p><blockquote><p>提示：<code>Source</code> 是 Webpack 内代表资源内容的类，由 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack-sources%2Fblob%2FHEAD%2Flib%2Findex.js" target="_blank" rel="noreferrer">webpack-source</a> 库实现，支持 <code>RawSource/ConcatSource</code> 等子类型，用于实现文件读写、合并、修改、Sourcemap 等操作。</p></blockquote><h2 id="实例剖析-eslint-webpack-plugin" tabindex="-1">实例剖析：<code>eslint-webpack-plugin</code> <a class="header-anchor" href="#实例剖析-eslint-webpack-plugin" aria-label="Permalink to &quot;实例剖析：`eslint-webpack-plugin`&quot;">​</a></h2><blockquote><p>学习如何提交错误日志</p></blockquote><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack-contrib%2Feslint-webpack-plugin" target="_blank" rel="noreferrer">eslint-webpack-plugin</a> 是一个基于 ESLint 实现的代码风格检查插件，它的实现比较巧妙，一是使用多个 Hook，在不同时间点执行 Lint 检查；二是复用 Webpack 内置的 <code>error/warn</code> 方法提交代码风格问题。核心逻辑：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ESLintWebpackPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compiler.hooks.run.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tapPromise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.key, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(c, options, wanted, exclude)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">wanted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">exclude</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compiler.hooks.compilation.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.key, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compilation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ({ lint, report, threads } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> linter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.key, options, compilation));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> files</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 单个模块成功编译后触发</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      compilation.hooks.succeedModule.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.key, ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">resource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 判断是否需要检查该文件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          isMatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(file, wanted, { dot: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          !</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isMatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(file, exclude, { dot: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          lint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(file);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 所有模块构建完毕后触发</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      compilation.hooks.finishModules.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.key, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (files.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> threads </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          lint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(files);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 等待检查结果</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      compilation.hooks.additionalAssets.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tapPromise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.key, processResults);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> processResults</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>代码用到如下 Hook：</p><ul><li><code>compiler.hooks.compilation</code>：Compiler 环境初始化完毕，创建出 <code>compilation</code> 对象，准备开始执行构建前触发；</li><li><code>compilation.hooks.succeedModule</code>：Webpack 完成单个「模块」的读入、运行 Loader、AST 分析、依赖分析等操作后触发；</li><li><code>compilation.hooks.finishModules</code>：Webpack 完成「所有」模块的读入、运行 Loader、依赖分析等操作后触发；</li><li><code>compilation.hooks.additionalAssets</code>：构建、打包完毕后触发，通常用于为编译创建附加资产。</li></ul><p>其中，比较重要的是借助 <code>compilation.hooks.succeedModule</code> 钩子，在每个模块处理完毕之后立即通过 <code>lint</code> 函数添加非阻塞代码检查任务，相比于过去的 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Feslint-loader" target="_blank" rel="noreferrer">eslint-loader</a> 的阻塞式执行，这种方式能够提高 ESLint 的并发度，效率更高。</p><p>其次，借助 <code>compilation.hooks.additionalAssets</code> 钩子，在所有模块处理完毕后读取检查结果 —— 即 <code>processResults</code> 函数，核心代码：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> processResults</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">errors</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">warnings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> report</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (warnings </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">options.failOnWarning) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compilation.warnings.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(warnings);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (warnings </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> options.failOnWarning) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compilation.errors.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(warnings);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (errors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> options.failOnError) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compilation.errors.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(errors);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (errors </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">options.failOnError) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compilation.warnings.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(errors);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>代码读取 ESLint 执行结果(<code>report</code> 函数)，并使用 <code>compilation</code> 的 <code>errors</code> 与 <code>warnings</code> 数组提交错误/警告信息，这种方式只会输出错误信息，不会中断编译流程，运行效果如：</p><p><img src="/books/assets/3ad70295b2214f3ebb77b9024d41ae1f~tplv-k3u1fbpfcp-zoom-in-crop-mark_3024_0_0_0.BDXek41B.awebp" alt="image.png"></p><h2 id="实例剖析-defineplugin" tabindex="-1">实例剖析：<code>DefinePlugin</code> <a class="header-anchor" href="#实例剖析-defineplugin" aria-label="Permalink to &quot;实例剖析：`DefinePlugin`&quot;">​</a></h2><blockquote><p>学习在插件中如何与 AST 结构交互</p></blockquote><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack" target="_blank" rel="noreferrer">DefinePlugin</a> 是 Webpack 官方实现的，用于构建时注入预定义常量的插件，先简单回顾一下<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebpack.js.org%2Fplugins%2Fdefine-plugin%2F" target="_blank" rel="noreferrer">用法</a>，如：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DefinePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;webpack&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> baseConfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DefinePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      PROD: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      VERSION: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;12.13.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>之后，Webpack 会帮我们替换掉代码中所有 <code>DefinePlugin</code> 声明的属性值，例如：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 源码：</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PROD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VERSION</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 构建结果：</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;5fa3b9&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p><code>DefinePlugin</code> 的 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack%2Fblob%2FHEAD%2Flib%2FDefinePlugin.js" target="_blank" rel="noreferrer">底层实现</a> 比较复杂，需要遍历 AST 找出变量名对应的代码位置之后再做替换，插件核心结构：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DefinePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compiler.hooks.compilation.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      &quot;DefinePlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compilation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">normalModuleFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handler</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          // 递归处理 `DefinePlugin` 参数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> walkDefinitions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">definitions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">prefix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            Object.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">keys</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(definitions).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">              const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> code</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> definitions[key];</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">              if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (isObject </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/*...*/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // 递归处理对象属性</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                walkDefinitions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(code, prefix </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                applyObjectDefine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prefix </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key, code);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">              applyDefineKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prefix, key);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">              applyDefine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prefix </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> key, code);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          // 替换基本类型的表达式值</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> applyDefine</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">isTypeof) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              // 借助 expression 钩子替换内容</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              parser.hooks.expression.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DefinePlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                /*...*/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // 处理 `&#39;typeof window&#39;: JSON.stringify(&#39;object&#39;),` 场景</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            parser.hooks.typeof.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DefinePlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              /*...*/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          // 替换引用类型的表达式值</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> applyObjectDefine</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">obj</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            parser.hooks.expression.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DefinePlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              /*...*/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          walkDefinitions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(definitions, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 监听 `parser` 钩子</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        normalModuleFactory.hooks.parser</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;javascript/auto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DefinePlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, handler);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        normalModuleFactory.hooks.parser</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;javascript/dynamic&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DefinePlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, handler);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        normalModuleFactory.hooks.parser</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;javascript/esm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DefinePlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, handler);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DefinePlugin;</span></span></code></pre></div><blockquote><p>提示：可能有同学注意到，上例代码中出现 <code>xxx.hooks.xxx.for(condition).tap</code> 形式的调用，这里的 <code>for</code> 函数可以理解为 Hook 的过滤条件，仅在满足 <code>condition</code> 时触发，后面章节会详细讲解。</p></blockquote><p>核心逻辑：</p><ol><li>使用 <code>normalModuleFactory.hooks.parser</code> 钩子(上例 48 行)，在 Webpack 创建出代码解析器 <code>Parser</code> 对象后执行 <code>handler</code> 函数。注意，此时还没有执行代码转 AST 操作；</li><li><code>walkDefinitions</code> 函数中递归遍历 <code>DefinePlugin</code> 参数对象，为每一个属性注册 <code>parser.hooks.expression</code> 钩子回调，该钩子会在 Webpack 遍历 AST 过程遇到表达式语句时触发；</li><li>在 <code>parser.hooks.expression</code> 回调中创建新的 <code>Dependency</code> 对象，调用 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub1s.com%2Fwebpack%2Fwebpack%2Fblob%2FHEAD%2Flib%2FModule.js%23L494" target="_blank" rel="noreferrer">addPresentationalDependency</a> 添加为模块依赖：</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> toConstantDependency</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">parser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">runtimeRequirements</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> constDependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> dep</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ConstDependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(value, expr.range, runtimeRequirements);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    dep.loc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> expr.loc;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 创建静态依赖对象，替换 loc 指定位置内容</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    parser.state.module.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addPresentationalDependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dep);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> applyDefine</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  parser.hooks.expression.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DefinePlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> strCode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> toCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/*...*/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/*...*/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      /*...*/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> toConstantDependency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(parser, strCode)(expr);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>之后，Webpack 会借助 Template 接口将上述 <code>Dependency</code> 打包进 Chunk 中，替换对应位置(<code>loc</code>)代码：</p><p><img src="/books/assets/4eaa247a0d034d6dbcc4a5624573311c~tplv-k3u1fbpfcp-zoom-in-crop-mark_3024_0_0_0.B1NyC-d8.awebp" alt="image.png"></p><p>这是一个功能效果看起来简单，但实现特别复杂的例子，底层需要使用 <code>Parser</code> 钩子遍历 AST 结构，之后借助 <code>Dependency</code> 声明代码依赖，最后借助 Template 替换代码内容，过程中已经涉及到许多 Webpack 底层对象。</p><p>这正是学习开发 Webpack 插件的难点，有时候你不仅仅需要了解每一个 Hook 的时机与作用、如何与上下文参数交互，还需要了解 Webpack 底层许多类型的实现、作用、接口等等，才能写出符合预期的功能，而 Webpack 是一个极度复杂、庞大的工具，这些具体知识点太多太碎，几乎不可能一一枚举。不过，我们可以换一种方式，从更高更抽象的视角审视 Webpack 插件架构，从“道”的角度加深理解。</p><h2 id="插件架构综述" tabindex="-1">插件架构综述 <a class="header-anchor" href="#插件架构综述" aria-label="Permalink to &quot;插件架构综述&quot;">​</a></h2><p>前端社区里很多有名的框架都各自有一套插件架构，例如 axios、quill、vscode、webpack、vue、rollup 等等。插件架构灵活性高，扩展性强，但通常架构复杂度更高，学习曲线更陡峭。插件架构至少需要解决三个方面的问题：</p><ul><li><strong>接口</strong>：需要提供一套逻辑接入方法，让开发者能够将代码插入特定环节，变更原始逻辑；</li><li><strong>输入</strong>：如何将上下文信息高效传导给插件；</li><li><strong>输出</strong>：插件内部通过何种方式影响整套运行体系。</li></ul><p>针对这些问题，webpack 基于 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fwebpack%2Ftapable" target="_blank" rel="noreferrer">tapable</a> 实现了：</p><ol><li>编译过程的特定节点以钩子形式，通知插件此刻正在发生什么事情；</li><li>通过 tapable 提供的回调机制，以参数方式传递上下文信息；</li><li>在上下文参数对象中附带了很多存在 Side Effect 的交互接口，插件可以通过这些接口改变。</li></ol><p>这一切都离不开 tapable，举例来说：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Compiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 在构造函数中，先初始化钩子对象</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.hooks </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      thisCompilation: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SyncHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;compilation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;params&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  compile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 特定时机触发特定钩子</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> compilation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Compilation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.hooks.thisCompilation.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">call</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(compilation);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><code>Compiler</code> 类型内部定义了 <code>thisCompilation</code> 钩子，并在 <code>compilation</code> 创建完毕后发布事件消息，插件开发者就可以基于这个钩子获取到最新创建出的 <code>compilation</code> 对象：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SomePlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    compiler.hooks.thisCompilation.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SomePlugin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">compilation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 上下文信息： compilation、params</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>钩子回调传递的 <code>compilation/params</code> 参数，就是 Webpack 希望传递给插件的上下文信息，也是插件能拿到的输入。不同钩子会传递不同的上下文对象，这一点在钩子被创建的时候就定下来了，比如：</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Compiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.hooks </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            /** </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {SyncBailHook&lt;Compilation&gt;}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            shouldEmit: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SyncBailHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;compilation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            /** </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {AsyncSeriesHook&lt;Stats&gt;}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            done: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AsyncSeriesHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;stats&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            /** </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {AsyncSeriesHook&lt;&gt;}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            additionalPass: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AsyncSeriesHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([]),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            /** </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {AsyncSeriesHook&lt;Compiler&gt;}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            beforeRun: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AsyncSeriesHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;compiler&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            /** </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {AsyncSeriesHook&lt;Compiler&gt;}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            run: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AsyncSeriesHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;compiler&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            /** </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {AsyncSeriesHook&lt;Compilation&gt;}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            emit: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AsyncSeriesHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;compilation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            /** </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {AsyncSeriesHook&lt;string, Buffer&gt;}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            assetEmitted: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AsyncSeriesHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;content&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            /** </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> {AsyncSeriesHook&lt;Compilation&gt;}</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            afterEmit: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AsyncSeriesHook</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;compilation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><ul><li><code>shouldEmit</code> 会被传入 <code>compilation</code> 参数；</li><li><code>done</code> 会被传入 <code>stats</code> 参数；</li><li>……</li></ul><p>这一设计贯穿 Webpack 整个执行过程，几乎无处不在，我们可以借此介入 Webpack 的运行逻辑。</p><p>插件架构的灵魂就在于，框架自身只负责实现最关键的核心流程，其它具体功能都尽量交给具体插件实现，包括 Webpack 仓库内也会内置非常多插件(如 <code>DefinePlugin/EntryPlugin</code> 等)，这就为我们提供了非常充分的学习素材。因此，我的建议是：</p><ol><li>先透彻理解上述 Webpack 插件架构的设计逻辑，捋清楚 Webpack 主流程与 Hook 之间的关系；</li><li>尝试用本文第一节提及的若干常见 Hook 与上下文参数对象编写一些示例，对这些钩子有一个感性认知；</li><li>尝试分析一些常用但不是很复杂的插件源码，例如文中提到的 <code>eslint-webpack-plugin</code> 等，或者：<code>terser-webpack-plugin</code>、<code>stylelint-webpack-plugin</code> 等，从中学习一些编写插件的常见方法；</li><li>最后，在实际开发时参考相关插件源码实现，带着问题与明确目标，逐行分析插件实现逻辑。</li></ol><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>综上，Webpack 插件在代码形态上是一个带 <code>apply</code> 方法的对象，我们可以在 <code>apply</code> 函数中注册各式各样的 Hook 回调，监听对应事件，之后在回调中修改上下文状态，达到干预 Webpack 构建逻辑的效果。</p><p>由此可见，编写插件时大部分工作都围绕 Hook 展开，因此我们需要理解构建过程中的不同环节会触发什么 Hook、对应传递什么上下文参数、如何与上下文参数对象交互等，而学习这些知识最高效的方式，我认为是阅读、分析各种开源插件源码。例如文章中提及的：</p><ul><li>从 <code>imagemin-webpack-plugin</code> 学习：如何借助 <code>assets</code> 数组修改最终产物内容；</li><li>从 <code>eslint-webpack-plugin</code> 学习：如何提交错误信息；</li><li>从 <code>DefinePlugin</code> 学习：如何与 AST 结构交互。</li></ul><p>相信通过阅读这些内容，你已经对 Webpack 插件的形态与开发方式有了一个基本理解，下一章节我会继续抽象一些常见的开发用例，包括：校验插件参数、提交日志、搭建自动化测试环境等，帮助你进一步掌握插件的开发方法。</p><h2 id="思考题" tabindex="-1">思考题 <a class="header-anchor" href="#思考题" aria-label="Permalink to &quot;思考题&quot;">​</a></h2><p>插件架构设计算是许多优秀软件工程项目的标配，那么作为对比，Rollup 又是怎么实现插件扩展能力的呢？感兴趣的同学可以参考相关源码，交叉学习。</p></div></div></main><footer class="VPDocFooter" data-v-13595e85 data-v-a195f222><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-a195f222><span class="visually-hidden" id="doc-footer-aria-label" data-v-a195f222>Pager</span><div class="pager" data-v-a195f222><a class="VPLink link pager-link prev" href="/books/pamphlet/webpack5/20%20Loader%20%E5%BC%80%E5%8F%91%E8%BF%9B%E9%98%B6%EF%BC%9A%E5%A6%82%E4%BD%95%E7%94%A8%E5%A5%BD%20Loader%20%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%EF%BC%9F.html" data-v-a195f222><!--[--><span class="desc" data-v-a195f222>Previous page</span><span class="title" data-v-a195f222>20 Loader 开发进阶：如何用好 Loader 扩展开发工具？</span><!--]--></a></div><div class="pager" data-v-a195f222><a class="VPLink link pager-link next" href="/books/pamphlet/webpack5/22%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%BF%9B%E9%98%B6%EF%BC%9A%E5%A6%82%E4%BD%95%E6%8F%90%E5%8D%87%E6%8F%92%E4%BB%B6%E5%81%A5%E5%A3%AE%E6%80%A7%EF%BC%9F.html" data-v-a195f222><!--[--><span class="desc" data-v-a195f222>Next page</span><span class="title" data-v-a195f222>22 插件开发进阶：如何提升插件健壮性？</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"U1dLUXP6\",\"pamphlet_advanced-guide-to-mastering-typescript_1.开篇：用正确的方式学习 typescript.md\":\"D_8QV828\",\"pamphlet_advanced-guide-to-mastering-typescript_10.结构化类型系统：类型兼容性判断的幕后.md\":\"B3sLRGRH\",\"pamphlet_advanced-guide-to-mastering-typescript_11.类型系统层级：从 top type 到 bottom type.md\":\"CW8TWwXy\",\"pamphlet_advanced-guide-to-mastering-typescript_12.类型里的逻辑运算：条件类型与 infer.md\":\"xU0psT44\",\"pamphlet_advanced-guide-to-mastering-typescript_13.内置工具类型基础：别再妖魔化工具类型了！.md\":\"D0VrQqrx\",\"pamphlet_advanced-guide-to-mastering-typescript_14.反方向类型推导：用好上下文相关类型.md\":\"BTcl0GBX\",\"pamphlet_advanced-guide-to-mastering-typescript_15.数类型：协变与逆变的比较.md\":\"mIqZOV9j\",\"pamphlet_advanced-guide-to-mastering-typescript_16.了解类型编程与类型体操的意义，找到平衡点.md\":\"sut4cKDb\",\"pamphlet_advanced-guide-to-mastering-typescript_17.内置工具类型进阶：类型编程进阶.md\":\"D9wajpaJ\",\"pamphlet_advanced-guide-to-mastering-typescript_18.基础类型新成员：模板字符串类型入门.md\":\"DpbBMtaz\",\"pamphlet_advanced-guide-to-mastering-typescript_19.类型编程新范式：模板字符串工具类型进阶.md\":\"DPcgtBQ6\",\"pamphlet_advanced-guide-to-mastering-typescript_2.工欲善其事：打造最舒适的 typescript 开发环境.md\":\"DKlxamWf\",\"pamphlet_advanced-guide-to-mastering-typescript_20.工程层面的类型能力：类型声明、类型指令与命名空间.md\":\"BSQAxwTq\",\"pamphlet_advanced-guide-to-mastering-typescript_21.在 react 中愉快地使用 typescript：内置类型与泛型坑位.md\":\"DcTvzc5I\",\"pamphlet_advanced-guide-to-mastering-typescript_22.让 eslint 来约束你的 typescript 代码：配置与规则集介绍.md\":\"d-uUsUhn\",\"pamphlet_advanced-guide-to-mastering-typescript_23.全链路 typescript 工具库，找到适合你的工具.md\":\"BRCvSNmw\",\"pamphlet_advanced-guide-to-mastering-typescript_24.说说 typescript 和 ecmascript 之间那些事儿.md\":\"CCQcEX5i\",\"pamphlet_advanced-guide-to-mastering-typescript_25.装饰器与反射元数据：了解装饰器基本原理与应用.md\":\"CetiJKc_\",\"pamphlet_advanced-guide-to-mastering-typescript_26.控制反转与依赖注入：基于装饰器的依赖注入实现.md\":\"DmSY6qAX\",\"pamphlet_advanced-guide-to-mastering-typescript_27.tsconfig 全解（上）：构建相关配置.md\":\"CQ_kzKR_\",\"pamphlet_advanced-guide-to-mastering-typescript_28.tsconfig 全解（下）：检查相关、工程相关配置.md\":\"Ca5YEmGk\",\"pamphlet_advanced-guide-to-mastering-typescript_29.基于 prisma _ nestjs 的 node api ：前置知识储备.md\":\"qVkLIY4W\",\"pamphlet_advanced-guide-to-mastering-typescript_3.进入类型的世界：理解原始类型与对象类型.md\":\"ENqM9xwv\",\"pamphlet_advanced-guide-to-mastering-typescript_30.基于 prisma _ nestjs 的 node api ：项目开发与基于 heroku 部署.md\":\"CP9IA2jb\",\"pamphlet_advanced-guide-to-mastering-typescript_31.玩转 typescript ast：ast checker 与 codemod.md\":\"Btu7tu71\",\"pamphlet_advanced-guide-to-mastering-typescript_32.感谢相伴：是结束，也是开始.md\":\"5ccSZKgz\",\"pamphlet_advanced-guide-to-mastering-typescript_33.漫谈篇：面试中的 typescript.md\":\"6orPbGe3\",\"pamphlet_advanced-guide-to-mastering-typescript_4.掌握字面量类型与枚举，让你的类型再精确一些.md\":\"D5zIt48X\",\"pamphlet_advanced-guide-to-mastering-typescript_5.函数与 class 中的类型：详解函数重载与面向对象.md\":\"B_mMUIKD\",\"pamphlet_advanced-guide-to-mastering-typescript_6.探秘内置类型：any、unknown、never 与类型断言.md\":\"BzjiECgx\",\"pamphlet_advanced-guide-to-mastering-typescript_7.类型编程好帮手：typescript 类型工具（上）.md\":\"BZ84_0rA\",\"pamphlet_advanced-guide-to-mastering-typescript_8.类型编程好帮手：typescript 类型工具（下）.md\":\"CABE35h_\",\"pamphlet_advanced-guide-to-mastering-typescript_9.类型编程基石：typescript 中无处不在的泛型.md\":\"8xWtTEQw\",\"pamphlet_webpack5_1 重新认识 webpack：旧时代的破局者.md\":\"cBY-O5Mi\",\"pamphlet_webpack5_10 深入理解图像加载原理与最佳实践.md\":\"BD0Q5_vC\",\"pamphlet_webpack5_11 深入理解 webpack 核心配置结构.md\":\"TOepJP9_\",\"pamphlet_webpack5_12 构建性能：分享 7 款常用的性能分析工具.md\":\"CYcfl7bn\",\"pamphlet_webpack5_13 如何使用 webpack 持久化缓存大幅提升构建性能？.md\":\"C4XOyKbr\",\"pamphlet_webpack5_14 webpack 都有哪些实现并行构建的方法？.md\":\"BBqrqBN2\",\"pamphlet_webpack5_15 有哪些值得学习的构建性能极致优化技巧？.md\":\"zh4LlGWK\",\"pamphlet_webpack5_16 如何正确使用 splitchunks提升应用性能？.md\":\"CictyYi-\",\"pamphlet_webpack5_17 不止 terser：揭秘代码压缩的门门道道.md\":\"DEob2TEP\",\"pamphlet_webpack5_18 还有哪些值得学习的应用性能极致优化技巧？.md\":\"BAjnVNUH\",\"pamphlet_webpack5_19 loader 开发基础：从开源项目学到的 loader 开发技巧.md\":\"DYeXnb-I\",\"pamphlet_webpack5_2 如何理解 webpack 配置底层结构逻辑？.md\":\"CyLA8VR5\",\"pamphlet_webpack5_20 loader 开发进阶：如何用好 loader 扩展开发工具？.md\":\"DDHvDqT6\",\"pamphlet_webpack5_21 插件开发基础：实例剖析插件基本形态与架构逻辑.md\":\"BIaE80UL\",\"pamphlet_webpack5_22 插件开发进阶：如何提升插件健壮性？.md\":\"DUJ7efTo\",\"pamphlet_webpack5_23 插件架构：hook 体系是如何影响 webpack 架构的？.md\":\"BXBvzv5o\",\"pamphlet_webpack5_24 init、make、seal：真正读懂 webpack 核心流程.md\":\"6XkCVVZ5\",\"pamphlet_webpack5_25 dependency graph：如何管理模块间依赖？.md\":\"BXzerjpk\",\"pamphlet_webpack5_26 chunk：三种产物的打包逻辑.md\":\"CFOvls2h\",\"pamphlet_webpack5_27 runtime：模块编译打包及运行时逻辑.md\":\"BpJOf5TJ\",\"pamphlet_webpack5_28 tree-shaking：如何删除无用模块导出？.md\":\"D_qCWMXJ\",\"pamphlet_webpack5_29 sourcemap：源码映射原理与应用技巧.md\":\"nuBMkRJY\",\"pamphlet_webpack5_3 如何借助 babel_ts_eslint 构建现代 js 工程环境？.md\":\"DbFN5DBT\",\"pamphlet_webpack5_30 hmr：如何动态替换页面代码？.md\":\"BPOZdLv0\",\"pamphlet_webpack5_4 如何借助预处理器、postcss 等构建现代 css 工程环境？.md\":\"2I939Owg\",\"pamphlet_webpack5_5 如何搭建 vue 全栈开发环境？.md\":\"CExZwSQB\",\"pamphlet_webpack5_6 如何搭建 react 全栈开发环境？.md\":\"BpjzblDW\",\"pamphlet_webpack5_7 使用 webpack 构建 npm library 的正确方式.md\":\"Bybfatev\",\"pamphlet_webpack5_8 使用 webpack 构建微前端应用.md\":\"BxvedUO4\",\"pamphlet_webpack5_9 如何借助 webpack 开发 pwa、node、electron 应用？.md\":\"zVLZpzsB\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"刘云露\",\"description\":\"一些有意思的东西\",\"base\":\"/books/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"小册\",\"items\":[{\"text\":\"Webpack5 核心原理与应用实践\",\"link\":\"/pamphlet/webpack5/1 重新认识 Webpack：旧时代的破局者.md\"},{\"text\":\"TypeScript全面进阶指南\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/1.开篇：用正确的方式学习 TypeScript.md\"}]},{\"text\":\"Examples\",\"link\":\"/markdown-examples\"}],\"sidebar\":[{\"text\":\"pamphlet\",\"items\":[{\"text\":\"advanced-guide-to-mastering-typeScript\",\"items\":[{\"text\":\"1.开篇：用正确的方式学习 TypeScript\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/1.开篇：用正确的方式学习 TypeScript\"},{\"text\":\"2.工欲善其事：打造最舒适的 TypeScript 开发环境\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/2.工欲善其事：打造最舒适的 TypeScript 开发环境\"},{\"text\":\"3.进入类型的世界：理解原始类型与对象类型\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/3.进入类型的世界：理解原始类型与对象类型\"},{\"text\":\"4.掌握字面量类型与枚举，让你的类型再精确一些\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/4.掌握字面量类型与枚举，让你的类型再精确一些\"},{\"text\":\"5.函数与 Class 中的类型：详解函数重载与面向对象\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/5.函数与 Class 中的类型：详解函数重载与面向对象\"},{\"text\":\"6.探秘内置类型：any、unknown、never 与类型断言\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/6.探秘内置类型：any、unknown、never 与类型断言\"},{\"text\":\"7.类型编程好帮手：TypeScript 类型工具（上）\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/7.类型编程好帮手：TypeScript 类型工具（上）\"},{\"text\":\"8.类型编程好帮手：TypeScript 类型工具（下）\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/8.类型编程好帮手：TypeScript 类型工具（下）\"},{\"text\":\"9.类型编程基石：TypeScript 中无处不在的泛型\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/9.类型编程基石：TypeScript 中无处不在的泛型\"},{\"text\":\"10.结构化类型系统：类型兼容性判断的幕后\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/10.结构化类型系统：类型兼容性判断的幕后\"},{\"text\":\"11.类型系统层级：从 Top Type 到 Bottom Type\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/11.类型系统层级：从 Top Type 到 Bottom Type\"},{\"text\":\"12.类型里的逻辑运算：条件类型与 infer\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/12.类型里的逻辑运算：条件类型与 infer\"},{\"text\":\"13.内置工具类型基础：别再妖魔化工具类型了！\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/13.内置工具类型基础：别再妖魔化工具类型了！\"},{\"text\":\"14.反方向类型推导：用好上下文相关类型\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/14.反方向类型推导：用好上下文相关类型\"},{\"text\":\"15.数类型：协变与逆变的比较\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/15.数类型：协变与逆变的比较\"},{\"text\":\"16.了解类型编程与类型体操的意义，找到平衡点\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/16.了解类型编程与类型体操的意义，找到平衡点\"},{\"text\":\"17.内置工具类型进阶：类型编程进阶\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/17.内置工具类型进阶：类型编程进阶\"},{\"text\":\"18.基础类型新成员：模板字符串类型入门\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/18.基础类型新成员：模板字符串类型入门\"},{\"text\":\"19.类型编程新范式：模板字符串工具类型进阶\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/19.类型编程新范式：模板字符串工具类型进阶\"},{\"text\":\"20.工程层面的类型能力：类型声明、类型指令与命名空间\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/20.工程层面的类型能力：类型声明、类型指令与命名空间\"},{\"text\":\"21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/21.在 React 中愉快地使用 TypeScript：内置类型与泛型坑位\"},{\"text\":\"22.让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/22.让 ESLint 来约束你的 TypeScript 代码：配置与规则集介绍\"},{\"text\":\"23.全链路 TypeScript 工具库，找到适合你的工具\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/23.全链路 TypeScript 工具库，找到适合你的工具\"},{\"text\":\"24.说说 TypeScript 和 ECMAScript 之间那些事儿\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/24.说说 TypeScript 和 ECMAScript 之间那些事儿\"},{\"text\":\"25.装饰器与反射元数据：了解装饰器基本原理与应用\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/25.装饰器与反射元数据：了解装饰器基本原理与应用\"},{\"text\":\"26.控制反转与依赖注入：基于装饰器的依赖注入实现\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/26.控制反转与依赖注入：基于装饰器的依赖注入实现\"},{\"text\":\"27.TSConfig 全解（上）：构建相关配置\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/27.TSConfig 全解（上）：构建相关配置\"},{\"text\":\"28.TSConfig 全解（下）：检查相关、工程相关配置\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/28.TSConfig 全解（下）：检查相关、工程相关配置\"},{\"text\":\"29.基于 Prisma + NestJs 的 Node API ：前置知识储备\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/29.基于 Prisma + NestJs 的 Node API ：前置知识储备\"},{\"text\":\"30.基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/30.基于 Prisma + NestJs 的 Node API ：项目开发与基于 Heroku 部署\"},{\"text\":\"31.玩转 TypeScript AST：AST Checker 与 CodeMod\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/31.玩转 TypeScript AST：AST Checker 与 CodeMod\"},{\"text\":\"32.感谢相伴：是结束，也是开始\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/32.感谢相伴：是结束，也是开始\"},{\"text\":\"33.漫谈篇：面试中的 TypeScript\",\"link\":\"/pamphlet/advanced-guide-to-mastering-typeScript/33.漫谈篇：面试中的 TypeScript\"}]},{\"text\":\"webpack5\",\"items\":[{\"text\":\"1 重新认识 Webpack：旧时代的破局者\",\"link\":\"/pamphlet/webpack5/1 重新认识 Webpack：旧时代的破局者\"},{\"text\":\"2 如何理解 Webpack 配置底层结构逻辑？\",\"link\":\"/pamphlet/webpack5/2 如何理解 Webpack 配置底层结构逻辑？\"},{\"text\":\"3 如何借助 Babel+TS+ESLint 构建现代 JS 工程环境？\",\"link\":\"/pamphlet/webpack5/3 如何借助 Babel+TS+ESLint 构建现代 JS 工程环境？\"},{\"text\":\"4 如何借助预处理器、PostCSS 等构建现代 CSS 工程环境？\",\"link\":\"/pamphlet/webpack5/4 如何借助预处理器、PostCSS 等构建现代 CSS 工程环境？\"},{\"text\":\"5 如何搭建 Vue 全栈开发环境？\",\"link\":\"/pamphlet/webpack5/5 如何搭建 Vue 全栈开发环境？\"},{\"text\":\"6 如何搭建 React 全栈开发环境？\",\"link\":\"/pamphlet/webpack5/6 如何搭建 React 全栈开发环境？\"},{\"text\":\"7 使用 Webpack 构建 NPM Library 的正确方式\",\"link\":\"/pamphlet/webpack5/7 使用 Webpack 构建 NPM Library 的正确方式\"},{\"text\":\"8 使用 Webpack 构建微前端应用\",\"link\":\"/pamphlet/webpack5/8 使用 Webpack 构建微前端应用\"},{\"text\":\"9 如何借助 Webpack 开发 PWA、Node、Electron 应用？\",\"link\":\"/pamphlet/webpack5/9 如何借助 Webpack 开发 PWA、Node、Electron 应用？\"},{\"text\":\"10 深入理解图像加载原理与最佳实践\",\"link\":\"/pamphlet/webpack5/10 深入理解图像加载原理与最佳实践\"},{\"text\":\"11 深入理解 Webpack 核心配置结构\",\"link\":\"/pamphlet/webpack5/11 深入理解 Webpack 核心配置结构\"},{\"text\":\"12 构建性能：分享 7 款常用的性能分析工具\",\"link\":\"/pamphlet/webpack5/12 构建性能：分享 7 款常用的性能分析工具\"},{\"text\":\"13 如何使用 Webpack 持久化缓存大幅提升构建性能？\",\"link\":\"/pamphlet/webpack5/13 如何使用 Webpack 持久化缓存大幅提升构建性能？\"},{\"text\":\"14 Webpack 都有哪些实现并行构建的方法？\",\"link\":\"/pamphlet/webpack5/14 Webpack 都有哪些实现并行构建的方法？\"},{\"text\":\"15 有哪些值得学习的构建性能极致优化技巧？\",\"link\":\"/pamphlet/webpack5/15 有哪些值得学习的构建性能极致优化技巧？\"},{\"text\":\"16 如何正确使用 SplitChunks提升应用性能？\",\"link\":\"/pamphlet/webpack5/16 如何正确使用 SplitChunks提升应用性能？\"},{\"text\":\"17 不止 Terser：揭秘代码压缩的门门道道\",\"link\":\"/pamphlet/webpack5/17 不止 Terser：揭秘代码压缩的门门道道\"},{\"text\":\"18 还有哪些值得学习的应用性能极致优化技巧？\",\"link\":\"/pamphlet/webpack5/18 还有哪些值得学习的应用性能极致优化技巧？\"},{\"text\":\"19 Loader 开发基础：从开源项目学到的 Loader 开发技巧\",\"link\":\"/pamphlet/webpack5/19 Loader 开发基础：从开源项目学到的 Loader 开发技巧\"},{\"text\":\"20 Loader 开发进阶：如何用好 Loader 扩展开发工具？\",\"link\":\"/pamphlet/webpack5/20 Loader 开发进阶：如何用好 Loader 扩展开发工具？\"},{\"text\":\"21 插件开发基础：实例剖析插件基本形态与架构逻辑\",\"link\":\"/pamphlet/webpack5/21 插件开发基础：实例剖析插件基本形态与架构逻辑\"},{\"text\":\"22 插件开发进阶：如何提升插件健壮性？\",\"link\":\"/pamphlet/webpack5/22 插件开发进阶：如何提升插件健壮性？\"},{\"text\":\"23 插件架构：Hook 体系是如何影响 Webpack 架构的？\",\"link\":\"/pamphlet/webpack5/23 插件架构：Hook 体系是如何影响 Webpack 架构的？\"},{\"text\":\"24 Init、Make、Seal：真正读懂 Webpack 核心流程\",\"link\":\"/pamphlet/webpack5/24 Init、Make、Seal：真正读懂 Webpack 核心流程\"},{\"text\":\"25 Dependency Graph：如何管理模块间依赖？\",\"link\":\"/pamphlet/webpack5/25 Dependency Graph：如何管理模块间依赖？\"},{\"text\":\"26 Chunk：三种产物的打包逻辑\",\"link\":\"/pamphlet/webpack5/26 Chunk：三种产物的打包逻辑\"},{\"text\":\"27 Runtime：模块编译打包及运行时逻辑\",\"link\":\"/pamphlet/webpack5/27 Runtime：模块编译打包及运行时逻辑\"},{\"text\":\"28 Tree-shaking：如何删除无用模块导出？\",\"link\":\"/pamphlet/webpack5/28 Tree-shaking：如何删除无用模块导出？\"},{\"text\":\"29 Sourcemap：源码映射原理与应用技巧\",\"link\":\"/pamphlet/webpack5/29 Sourcemap：源码映射原理与应用技巧\"},{\"text\":\"30 HMR：如何动态替换页面代码？\",\"link\":\"/pamphlet/webpack5/30 HMR：如何动态替换页面代码？\"}]}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>